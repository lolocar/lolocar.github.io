<!DOCTYPE html> 
<html> 
<head>
<style>
body {
  background-color: #111111;
  color: green;
}
</style>
</head>
<body> 

 <video controls id="myVideo" width="640" >
    <source src="test.webm" type="video/webm">
    <p>This browser does not support the video element.</p>
  </video>

<form>
  <input type="checkbox" id="dyn_bright" name="dyn_bright" onclick="update2()">
  <label for="dyn_bright"> Brightness</label>
  <input type="checkbox" id="dyn_contrast" name="dyn_contrast">
  <label for="dyn_contrast"> Contrast</label>
  <input type="checkbox" id="dyn_saturation" name="dyn_saturation">
  <label for="dyn_saturation"> Saturation</label><br>
</form>

<table><tr><td>Video Time</td><td><p id="input2">0</p></td><td> / Speed</td><td><p id="input1">1.0</p></td></tr></table>

<style type="text/css">
.green {
    color: #00FF00;
    border-style: none;
}
.yellow {
    color: #a87f32;
    border-style: none;
}
.black {
    color: #000000;
    border-style: none;
}

</style>

<script>
var vid = document.getElementById("myVideo");

vid.addEventListener("timeupdate",function(){
    var timeDisplay;
	timeDisplay = Math.floor(vid.currentTime);
	console.log(Math.floor(vid.currentTime));
	document.getElementById('input2').innerHTML = timeDisplay;
},false);

function getPlaySpeed() { 
  alert(vid.playbackRate);
} 

function setPlaySpeed(x){ 
  vid.playbackRate = x;
  document.getElementById('input1').innerHTML = x;
  if(x==1.2)
  {
	document.getElementById('input1').style.color = "red";
  }
  else if (x==2)
  {
  document.getElementById('input1').style.color = "green";  
  }

} 

function setPlaySpeedFast() { 
  vid.playbackRate = 2;
} 

function update2() {
  var illuminance = parseInt(document.getElementById("value_lux").innerHTML);
      
  var adjustment_b = Math.sqrt(illuminance)*2+70;	  
  
  if(document.getElementById("dyn_bright").checked==false)
	adjustment_b=100;
  if(adjustment_b>150)
	adjustment_b=150;
  vid.style.filter = "brightness("+adjustment_b+"%)";  
  document.getElementById("value_b").innerHTML = adjustment_b + " %";
	  
  var colorPart = Math.min(255, illuminance).toFixed(0);
  document.getElementById("box").style.backgroundColor =
    "rgb(" + colorPart + ", " + colorPart + ", " + colorPart + ")";
}

function update(illuminance) {
  document.getElementById("value_lux").innerHTML = illuminance + " lux";
      
  var adjustment_b = Math.sqrt(sensor.illuminance)*2+70;	  
  if(document.getElementById("dyn_bright").checked==false)
	adjustment_b=100;
  if(adjustment_b>150)
	adjustment_b=150;
  vid.style.filter = "brightness( "+adjustment_b+"%)";  
  document.getElementById("value_b").innerHTML = adjustment_b.toFixed(2) + " %";
	  
  var colorPart = Math.min(255, illuminance).toFixed(0);
  document.getElementById("box").style.backgroundColor =
    "rgb(" + colorPart + ", " + colorPart + ", " + colorPart + ")";
}

if ("AmbientLightSensor" in window) {
  try {
    var sensor = new AmbientLightSensor();
    sensor.addEventListener("reading", function (event) {
      update(sensor.illuminance);
    });
    sensor.start();
  } catch (e) {
    console.error(e);
  }
}

if ("ondevicelight" in window) {
  function onUpdateDeviceLight(event) {
    update(event.value);
  }
  
  window.addEventListener("devicelight", onUpdateDeviceLight);
}
</script> 
<div><p>Current light intensity is <b id="value_lux">unknown</b>.</p>
<div><p>Current brightness<b id="value_b">unknown</b>.</p>
<div id="box"></div>
<p>TEST.</p>
chrome://flags/#enable-generic-sensor
</body> 
</html>
